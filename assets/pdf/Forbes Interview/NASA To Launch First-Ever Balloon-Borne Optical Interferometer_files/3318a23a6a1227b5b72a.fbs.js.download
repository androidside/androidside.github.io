webpackJsonp([4],{390:function(e,t,i){"use strict";function n(){r=document.createElement("fbs-ad"),r.setAttribute("position","mobile"),document.body.appendChild(r)}function o(e){var t=window.external_services=window.external_services||{},i=t.ad_slots=t.ad_slots||{};e.render.map(function(e){return{creative_id:e.creativeId,line_item_id:e.lineItemId,size_width:e.size&&e.size[0],size_height:e.size&&e.size[1],slot_id:e.slot&&e.slot.getSlotElementId()}}).subscribe(function(e){i[e.slot_id]=e})}Object.defineProperty(t,"__esModule",{value:!0});var r,s,c=function(){function e(){}return e.getOffset=function(e){if(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}}},e}(),a=i(1),l=(i.n(a),i(75)),d=(i.n(l),i(63)),u=(i.n(d),i(61)),p=(i.n(u),i(140)),h=(i.n(p),this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),f=function(e){function t(){var t=e.call(this)||this;return t.leaderboardAd=document.querySelector(".top-ad-container"),t}return h(t,e),Object.defineProperty(t,"observedAttributes",{get:function(){return["railIndex"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"railIndex",{get:function(){return this._railIndex},set:function(e){this._railIndex=e,this.setAttribute("railIndex",e+"")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return"false"!==(this.getAttribute("is-active")||"false")},set:function(e){this.setAttribute("is-active",e+"")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"progressive",{get:function(){return"false"!==(this.getAttribute("progressive")||"false")},set:function(e){this.setAttribute("progressive",e+"")},enumerable:!0,configurable:!0}),t.prototype.connectedCallback=function(){this.init()},t.prototype.attributeChangedCallback=function(e,t,i,n){"railIndex"===e&&i!==t&&(this.railIndex=+i)},t.prototype.refresh=function(){var e=this;this.ad_load_complete=!1,a.Observable.from(this.querySelectorAll('[position="recx"]')).subscribe(function(t){e.removeChild(t)}),this.loge.refresh(),this.rec.refresh(),this.sponLogoAd.refresh(),this.scrollSubs.unsubscribe(),this.registerSticky()},t.prototype.startAdRail=function(){this.progressive||this.addAd("loge"),this.addAd("rec"),this.addAd("spon-logo"),this.registerSticky()},t.prototype.registerSticky=function(){var e=this;this.scrollSubs=a.Observable.fromEvent(window,"scroll").filter(function(){return e.isActive}).subscribe(function(t){return e.stickyHandler()})},t.prototype.subscribeForNextAd=function(){var e=this;a.Observable.fromEvent(window,"scroll").throttleTime(100).first(function(){return e.getBoundingClientRect().bottom-window.innerHeight<.25*window.innerHeight}).subscribe(function(){e.addAd(e.getAvailableSpace()>e.maxRecXSpace+e.maxLogeSpace?"recx":"loge")})},t.prototype.init=function(){var e=this;this.margin_between_ads=600,this.ad_load_complete=!1,this.maxRecXSpace=600+this.margin_between_ads,this.maxLogeSpace=600+this.margin_between_ads,this.railIndex=+this.getAttribute("railIndex"),setTimeout(function(){e.startAdRail()})},t.prototype.listenToRender=function(e){var t=this;e.addEventListener("render",function(i){var n=i.detail;"rec"===e.position&&(t.rec_height=n.size[1],e.style.width=n.size[0]+"px",e.style.height=t.rec_height+"px"),"loge"!==e.position&&"spon-logo"!==e.position&&(t.progressive?t.subscribeForNextAd():t.addAd("recx")),e.removeEventListener("render")})},t.prototype.stickyHandler=function(){var e,t=this.rec?this.rec.firstElementChild:null,i=this.querySelector('[position="recx"]')||this.querySelector('[position="loge"]'),n=this.leaderboardAd.classList.contains("sticky")?this.leaderboardAd:null,o=n?n.clientHeight:null,r=pageYOffset,s=c.getOffset(this).top+this.sponLogoAd.clientHeight+(this.sponLogoAd.empty?0:20),a=s-(o||30);i&&(e=c.getOffset(i).top-this.rec_height-60),t&&(a-r>0?(t.style.position="relative",t.style.top="0px"):a-r<=0&&r<e?(t.style.position="fixed",t.style.top=(o||30)+"px"):r>e&&(t.style.position="absolute",t.style.top=i.offsetTop-30-this.rec_height+"px"))},t.prototype.addAd=function(e){if(!this.progressive&&"recx"===e&&this.getAvailableSpace()<this.maxRecXSpace)return void(this.ad_load_complete=!0);var t=document.createElement("fbs-ad");t.position=e,this.railIndex>=0&&(t.adId="ad-rail-"+this.railIndex+"-"+e),this.listenToRender(t),e.startsWith("rec")||(t.hideEmpty=!0),"loge"===e?(this.loge=t,this.appendChild(t)):"spon-logo"===e?(this.sponLogoAd=t,this.insertBefore(t,this.rec)):("rec"===e&&(this.rec=t),this.insertBefore(t,this.loge))},t.prototype.getAvailableSpace=function(){return this.parentElement.parentElement.getBoundingClientRect().bottom-this.getBoundingClientRect().bottom},t}(HTMLElement),b=(i(392),i(32)),g=(i.n(b),i(133));document.addEventListener("FbsAdsBootstrapped",function(){return customElements.define("fbs-ad-rail",f)}),window.TRANSFER_STATE&&window.TRANSFER_STATE.adsConfig&&function(){s=window.TRANSFER_STATE.FORBES_CACHE.is_mobile;var e=window.fbsads=new g.b;e.bootstrap(window.TRANSFER_STATE.adsConfig),s&&n(),o(e)}();var m=i(135);(window.trackingService=window.trackingService||new m.a).setEnvironment(((window.TRANSFER_STATE||{}).FORBES_CACHE||{}).environmentName);var v=i(391);i.n(v),i(409),i(411),i(413),i(427)}},[390]);
//# sourceMappingURL=3318a23a6a1227b5b72a.fbs.map